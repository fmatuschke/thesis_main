\documentclass[tikz]{standalone}
\usepackage{float}              % [H]
\usepackage{graphicx}           % (pdf, png, jpg, eps)
\usepackage{pgfplots}
\usepackage{siunitx}
\usepackage{currfile}
\usepackage{ifthen}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=1.17}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{groupplots}
\usepgfplotslibrary{statistics}
\usepgfplotslibrary{fillbetween}
\tikzset{>=latex}
\DeclareSIUnit{\arbitraryunit}{a.u.}
% 
\newlength{\width}
\newlength{\height}
\setlength{\width}{13.87303cm} %5.462 inch
\setlength{\height}{22.37076cm} %8,807 inch
\def\datapath{../../__PATH__/analysis}
\directlua0{
  pdf.setinfo ("/Path: (__PATH__)")
}
% 
\def\vrf{\langle{r_f}\rangle}
\def\vfl{\nu_{l}}
\def\vfr{\nu_{r}}
% 
\definecolor{dark21}{HTML}{1b9e77}
\definecolor{dark22}{HTML}{d95f02}
\definecolor{dark23}{HTML}{7570b3}
\colorlet{RED}{dark22}
\colorlet{GREEN}{dark21}
\colorlet{BLUE}{dark23} 
% 
\pgfplotsset{
   every tick label/.append style={font=\small,},
   title style={font=\normalsize,},
   Boxplot/.style={
      mark=*,
      mark size=0.1pt,
      mark options={fill=black},
      boxplot={%
         draw position={\plotnumofactualtype},
         draw direction=y,
      },
      fill=GREEN, draw=black,
   },
}
% 
\newcommand{\plotgt}[3]{
\pgfplotsset{update limits=false}
\def\nboxes{9}
\addplot+[mark=none, white, smooth,
   dash=on 0.9pt off 0.6pt phase 0.2pt, line width=0.8pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_25}, col sep=comma, row sep=newline,
   ]{#1};
\addplot+[mark=none, black, smooth, name path=A,
   dash=on 0.5pt off 1pt phase 0pt, line width=0.4pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_25}, col sep=comma, row sep=newline,
   ]{#1};
% 
\addplot+[mark=none, white, smooth,
   % dash=on 3.4pt off 2.6pt phase 0.2pt, line width=0.8pt
   dash=on 0.9pt off 0.6pt phase 0.2pt, line width=0.8pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_50}, col sep=comma, row sep=newline,
   ]{#1};
\addplot+[mark=none, black, smooth,
   % dash=on 3pt off 3pt phase 0pt, line width=0.4pt
   dash=on 0.5pt off 1pt phase 0pt, line width=0.4pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_50}, col sep=comma, row sep=newline,
   ]{#1};
% 
\addplot+[mark=none, white, smooth,
   dash=on 0.9pt off 0.6pt phase 0.2pt, line width=0.8pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_75}, col sep=comma, row sep=newline,
   ]{#1};
\addplot+[mark=none, black, smooth, name path=B,
   dash=on 0.5pt off 1pt phase 0pt, line width=0.4pt] table[%
   x expr={\thisrow{#2}/90*\nboxes}, y={#3_75}, col sep=comma, row sep=newline,
   ]{#1};
% 
\addplot[gray!30] fill between [of=A and B];
\pgfplotsset{cycle list shift=-7}
\pgfplotsset{update limits=true}
}
%  
\begin{document}
% 
% \foreach \psi in {0.7} {
\foreach \psi in {0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9} {
% 
\directlua{tex.print('\string\\message{\psi}')}
% 
\begin{tikzpicture}[]
% 
\begin{groupplot}[%
   group style={
      group size=2 by 3,
      horizontal sep=1cm,
      vertical sep=1cm,
      ylabels at=edge left,
   },
   width = 0.495\width,
   height = 0.275\height,
   xmin=-0.5, xmax=9.5,
   xtick={0,3,6,9},
   xticklabels={$0$, $30$, $60$, $90$},
   xlabel={$\Omega / \si{\degree}$},
   every axis x label/.style={
      at={(ticklabel* cs:1.0,0.0)},
      anchor=north west,
   },
   every axis title/.append style={
      yshift=-8pt,
   },
   enlarge y limits,
   ymajorgrids,
   clip=true,
   cycle list/Paired-10,
]
% 
\nextgroupplot[title={\vphantom{/}transmittance}]
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={epa_trans_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
% 
\nextgroupplot[title={\vphantom{/}retardation}]
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={epa_ret_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
% 
\nextgroupplot[title={\vphantom{/}direction / $\si{\degree}$}]
\plotgt{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi_model.csv}{omega}{phi}
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={rofl_dir_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
% 
\nextgroupplot[title={\vphantom{/}inclination / $\si{\degree}$}]
\plotgt{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi_model.csv}{omega}{alpha}
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={rofl_inc_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
\pgfplotsset{update limits=false}
% individual populations
\addplot+[mark=none, black, densely dotted]  coordinates {(0,0) (9,0)};
\addplot+[mark=none, black, densely dotted]  coordinates {(0,0) (9,90)};
% circmean
\addplot+[mark=none, white, smooth,
   dash=on 3.4pt off 2.6pt phase 0.2pt, line width=0.8pt]  table[%
   x={x}, y={y}, col sep=comma, row sep=newline,
   ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi_theo_incl.csv};
\addplot+[mark=none, black, smooth,
   dash=on 3pt off 3pt phase 0pt, line width=0.4pt]  table[%
   x={x}, y={y}, col sep=comma, row sep=newline,
   ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi_theo_incl.csv};
\pgfplotsset{update limits=true}
% 
% 
\nextgroupplot[title={\vphantom{/}trel}]
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={rofl_trel_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
% 
\nextgroupplot[title={\vphantom{/}domega / $\si{\degree}$}]
\plotgt{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi_model.csv}{omega}{domega}
\foreach \omega in {0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0} {      
   \addplot+[Boxplot] table[%
      y={domega_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
\end{groupplot}
% 
% \coordinate (CA) at (group c1r1.north);
% \coordinate (CB) at (group c2r1.north);
\node[anchor=south] at ($(group c1r1.north)!0.5!(group c2r1.north) + (0,0.5)$) {inclined fiber pop., $\Psi = \psi$};
% 
% center axis
\coordinate (PA) at (group c1r2.west);
\coordinate (PB) at (group c2r2.east);
\coordinate (PC) at (current bounding box.west);
\path[] let \p1 = ($(PA)-(PC)$) in ($(PA) - (\x1,0)$) -- ($(PB) + (\x1,0)$);
% 
\end{tikzpicture}
}
% % 
% % 
% 
% 
% 
% 
% 
% 
\pgfplotsset{
   every tick label/.append style={font=\small,},
   title style={font=\normalsize,},
   Boxplot/.style={
      boxplot={draw position={\plotnumofactualtype+4.5},},
      boxplot/draw direction=y,
      fill=GREEN, draw=black,
   },
}
% 
\foreach \psi in {1.0} {
% 
\directlua{tex.print('\string\\message{\psi}')}
% 
\begin{tikzpicture}[]
% 
\begin{groupplot}[%
   group style={
      group size=2 by 3,
      horizontal sep=1cm,
      vertical sep=1cm,
      ylabels at=edge left,
   },
   width = 0.495\width,
   height = 0.275\height,
   xmin=-0.5, xmax=9.5,
   xtick={4.5},
   xticklabels={$0$},
   xlabel={$\Omega / \si{\degree}$},
   every axis x label/.style={
      at={(ticklabel* cs:1.0,0.0)},
      anchor=north west,
   },
   every axis title/.append style={
      yshift=-8pt,
   },
   enlarge y limits,
   ymajorgrids,
   clip=false,
   cycle list/Paired-10,
]
% 
\nextgroupplot[title={\vphantom{/}transmittance / $\si{\arbitraryunit}$}]
\foreach \omega in {0.0} {      
   \addplot+[Boxplot] table[%
      y={epa_trans_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
\nextgroupplot[title={\vphantom{/}retardation}]
\foreach \omega in {0.0} {       
   \addplot+[Boxplot] table[%
      y={epa_ret_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
\nextgroupplot[title={\vphantom{/}direction / $\si{\degree}$}]
\foreach \omega in {0.0} {       
   \addplot+[Boxplot] table[%
      y={rofl_dir_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
   % \addplot+[mark=none, BLUE, dashed] coordinates {(0,0) (9,0)};
   % \addplot+[mark=none, black, dashed] coordinates {(0,0) (9,90)};
}
% 
\nextgroupplot[title={\vphantom{/}inclination / $\si{\degree}$}]
\foreach \omega in {0.0} {        
   \addplot+[Boxplot] table[%
      y={rofl_inc_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
   % \addplot+[mark=none, black, dashed] coordinates {(0,0) (9,0)};
}
% 
\nextgroupplot[title={\vphantom{/}trel}]
\foreach \omega in {0.0} {       
   \addplot+[Boxplot] table[%
      y={rofl_trel_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
% 
\nextgroupplot[title={\vphantom{/}domega / $\si{\degree}$}]
\foreach \omega in {0.0} {     
   \addplot+[Boxplot] table[%
      y={domega_\omega}, col sep=comma, row sep=newline,
      ]{\datapath/cube_2pop_135_rc1_inclined_plots_inclined_pop_psi_\psi.csv};
}
%
\end{groupplot}
% 
% \coordinate (CA) at (group c1r1.north);
% \coordinate (CB) at (group c2r1.north);
\node[anchor=south] at ($(group c1r1.north)!0.5!(group c2r1.north) + (0,0.5)$) {inclined fiber pop., $\Psi = \psi$};
% 
% center axis
\coordinate (PA) at (group c1r2.west);
\coordinate (PB) at (group c2r2.east);
\coordinate (PC) at (current bounding box.west);
\path[] let \p1 = ($(PA)-(PC)$) in ($(PA) - (\x1,0)$) -- ($(PB) + (\x1,0)$);
% 
\end{tikzpicture}
}
% 
% 
\end{document}
